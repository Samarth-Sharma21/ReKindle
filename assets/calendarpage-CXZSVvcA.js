import{v as R,g as _,e as O,r as c,j as e,P as m,B as t,s as i,_ as o,V,q as u,n as A,L as F,x as B,k as E,I as $}from"./index-BmLVi8vg.js";import{C as H,a as X}from"./calendarandtasks-DeYxh6G_.js";import"./cjs-T6Auk3jY.js";import{A as Y}from"./ArrowBack-BAfnpC9L.js";import{i as j,a as Q,E as w}from"./isFuture-5SdCYpWX.js";import{A as J}from"./ArrowForward-BI0FkxmS.js";import{S as K}from"./Search-4fzQX_90.js";import{f as Z}from"./format-FSiKa7TQ.js";import{T as ee}from"./TextField-BSr3M5TF.js";import{I as re}from"./InputAdornment-BIraHNGR.js";import{C as L}from"./Chip-BKtNi0i9.js";import{C as te}from"./Container-Bvb4e2sG.js";import{G as h}from"./Grid-le5V3Wf4.js";import"./Add-CRsxodIX.js";import"./Delete-C-JMUuhf.js";import"./Edit-CqOAxFTu.js";import"./DialogTitle-BA7xkFFj.js";import"./useFormControl-c-FtK5bv.js";import"./visuallyHidden-Dan1xhjv.js";import"./Snackbar-DxAnmTar.js";import"./Alert-DHf0O5zk.js";const se=({isWidget:n=!1})=>{const{user:f}=R(),s=_(),l=s.palette.mode==="dark",y=O(),[d,G]=c.useState([]),[g,b]=c.useState(!1),[x,P]=c.useState(""),[p,q]=c.useState("");c.useEffect(()=>{(async()=>{try{b(!0);const{data:{user:a},error:U}=await B.auth.getUser();if(U||!a){b(!1);return}const{data:D,error:W}=await B.from("tasks").select("*").eq("user_id",a.id).order("due_date",{ascending:!0});if(W)throw W;D&&G(D)}catch(a){console.error("Error fetching tasks:",a.message),P("Failed to load tasks")}finally{b(!1)}})()},[]);const v=r=>p?r.filter(a=>a.title.toLowerCase().includes(p.toLowerCase())||a.description&&a.description.toLowerCase().includes(p.toLowerCase())):r,k=v(d.filter(r=>{const a=new Date(r.due_date);return j(a)})),C=v(d.filter(r=>{const a=new Date(r.due_date);return Q(a)&&!j(a)})),T=k.slice(0,n?2:6),S=C.slice(0,n?2:8),I=r=>{const a=new Date(r);return j(a)?"Today":Z(a,"MMM d, yyyy")},z=r=>{y(`/calendar?taskId=${r}`)},N=r=>{q(r.target.value)};return e.jsxs(m,{elevation:0,sx:{p:0,borderRadius:2,bgcolor:"transparent",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",width:"100%",maxWidth:"100%"},children:[e.jsx(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5,width:"100%"},children:e.jsxs(i,{variant:"h6",sx:{display:"flex",alignItems:"center",fontSize:{xs:"0.95rem",sm:"1.15rem",md:"1.25rem"},width:"100%"},children:[e.jsx(w,{sx:{mr:1,fontSize:{xs:"1.2rem",sm:"1.4rem",md:"1.5rem"}}}),"Upcoming Tasks"]})}),e.jsx(ee,{fullWidth:!0,placeholder:"Search tasks by name or description...",variant:"outlined",size:"small",value:p,onChange:N,sx:{mb:3,width:"100%",".MuiOutlinedInput-root":{borderRadius:1.5,bgcolor:l?o(s.palette.background.paper,.3):o(s.palette.background.paper,.7),fontSize:{xs:"0.85rem",sm:"1rem"}}},InputProps:{startAdornment:e.jsx(re,{position:"start",children:e.jsx(K,{color:"action"})})}}),g?e.jsx(t,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(V,{size:24})}):x?e.jsx(i,{color:"error",sx:{p:2},children:x}):e.jsxs(t,{sx:{flexGrow:1,overflow:"auto",width:"100%"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,sx:{fontSize:{xs:"0.9rem",sm:"1rem",md:"1.1rem"}},children:"Today's Tasks"}),e.jsx(L,{label:k.length,size:"small",color:"primary",sx:{height:20}})]}),T.length>0?e.jsx(t,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:{xs:1.5,sm:2},mb:3,width:"100%"},children:T.map(r=>e.jsx(u.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(m,{elevation:1,sx:{p:2,borderRadius:2,cursor:"pointer",bgcolor:r.completed?l?o(s.palette.success.main,.08):o(s.palette.success.light,.08):l?o(s.palette.background.paper,.3):o(s.palette.background.paper,.9),transition:"all 0.2s ease","&:hover":{transform:"translateY(-3px)",boxShadow:s.shadows[3]},display:"flex",flexDirection:"column",height:"100%"},onClick:()=>z(r.id),children:[e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",mb:1},children:[e.jsx(t,{sx:{mr:1.5},children:r.completed?e.jsx(H,{color:"success",fontSize:"small"}):e.jsx(w,{color:"warning",fontSize:"small"})}),e.jsxs(t,{sx:{flex:1,width:"100%",overflow:"hidden"},children:[e.jsx(i,{variant:"body1",fontWeight:r.completed?400:600,sx:{textDecoration:r.completed?"line-through":"none",color:r.completed?s.palette.text.secondary:s.palette.text.primary,fontSize:{xs:"0.9rem",sm:"1rem"},overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.title}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"}},children:I(r.due_date)})]})]}),r.description&&e.jsx(i,{variant:"body2",color:"text.secondary",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",mt:"auto",pt:1,fontSize:{xs:"0.75rem",sm:"0.8rem"}},children:r.description})]})},r.id))}):e.jsx(i,{color:"text.secondary",sx:{mb:3,pl:2},variant:n?"body2":"body1",children:"No tasks scheduled for today"}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:2,mt:4},children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,sx:{fontSize:{xs:"0.9rem",sm:"1rem",md:"1.1rem"}},children:"Upcoming Tasks"}),e.jsx(L,{label:C.length,size:"small",color:"info",sx:{height:20}})]}),S.length>0?e.jsx(t,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:{xs:1.5,sm:2},width:"100%"},children:S.map(r=>e.jsx(u.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(m,{elevation:1,sx:{p:2,borderRadius:2,cursor:"pointer",bgcolor:l?o(s.palette.background.paper,.3):o(s.palette.background.paper,.9),transition:"all 0.2s ease","&:hover":{transform:"translateY(-3px)",boxShadow:s.shadows[3]},display:"flex",flexDirection:"column",height:"100%"},onClick:()=>z(r.id),children:[e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",mb:1},children:[e.jsx(w,{sx:{mr:1.5},color:"info",fontSize:"small"}),e.jsxs(t,{sx:{flex:1,width:"100%",overflow:"hidden"},children:[e.jsx(i,{variant:"body1",fontWeight:600,sx:{color:s.palette.text.primary},children:r.title}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"}},children:I(r.due_date)})]})]}),r.description&&e.jsx(i,{variant:"body2",color:"text.secondary",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",mt:"auto",pt:1,fontSize:{xs:"0.75rem",sm:"0.8rem"}},children:r.description})]})},r.id))}):e.jsx(i,{color:"text.secondary",sx:{pl:2},variant:"body1",children:"No upcoming tasks scheduled"})]}),d.length===0&&!g&&!x&&e.jsxs(t,{sx:{textAlign:"center",py:3},children:[e.jsx(i,{variant:n?"body2":"body1",color:"text.secondary",children:"No tasks scheduled"}),e.jsx(A,{component:F,to:"/calendar",variant:"contained",color:"primary",size:n?"small":"medium",sx:{mt:2},children:"Add Task"})]}),d.length>0&&!g&&!x&&e.jsx(t,{sx:{display:"flex",justifyContent:"center",mt:"auto",pt:2},children:e.jsx(A,{component:F,to:"/calendar",variant:"outlined",color:"primary",fullWidth:!0,endIcon:e.jsx(J,{}),sx:{borderRadius:1,py:{xs:.75,sm:1},mb:2,fontWeight:500,fontSize:{xs:"0.85rem",sm:"1rem"},"&:hover":{color:"primary.main",borderColor:"primary.main",bgcolor:o(s.palette.primary.main,.05)}},children:"View All Tasks"})})]})},M={sm:576,md:768},Te=()=>{const n=_(),f=n.palette.mode==="dark",s=E(`(max-width:${M.sm}px)`);E(`(max-width:${M.md}px)`);const{user:l}=R(),y=O();return e.jsx(t,{sx:{width:"100%",maxWidth:"100%",overflowX:"hidden"},children:e.jsxs(te,{maxWidth:"lg",disableGutters:s,sx:{mt:{xs:2,sm:3},mb:{xs:4,sm:6},px:{xs:2,sm:3,md:4},boxSizing:"border-box",width:"100%",overflowX:"hidden"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:{xs:2,sm:3}},children:[e.jsx($,{onClick:()=>y(-1),sx:{mr:2},"aria-label":"go back",children:e.jsx(Y,{})}),e.jsx(i,{variant:"h4",component:"h1",sx:{fontWeight:600,fontSize:{xs:"1.5rem",sm:"1.8rem",md:"2rem"}},children:"Calendar"})]}),e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(u.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(m,{elevation:2,sx:{p:{xs:2,sm:3},borderRadius:2,height:"100%",minHeight:"500px",bgcolor:f?o(n.palette.background.paper,.6):o(n.palette.background.paper,.8),backdropFilter:"blur(10px)"},children:[e.jsx(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:e.jsx(i,{variant:"h6",sx:{fontWeight:500},children:"Calendar"})}),e.jsx(X,{activeTab:0,taskFrequency:"all"})]})})}),e.jsx(h,{item:!0,xs:12,md:6,children:e.jsx(u.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:e.jsx(m,{elevation:2,sx:{p:{xs:2,sm:3},borderRadius:2,height:"100%",minHeight:"500px",display:"flex",flexDirection:"column",bgcolor:f?o(n.palette.background.paper,.6):o(n.palette.background.paper,.8),backdropFilter:"blur(10px)"},children:e.jsx(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:e.jsx(t,{sx:{flexGrow:1,overflow:"auto"},children:e.jsx(h,{container:!0,spacing:2,sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(500px, 1fr))",gap:2},children:e.jsx(se,{})})})})})})})]})]})})};export{Te as default};

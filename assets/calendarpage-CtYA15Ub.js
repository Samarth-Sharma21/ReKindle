import{v as q,g as I,e as H,r as m,j as e,P as g,B as a,s as i,R as n,C as ee,q as C,n as z,L as P,x as G,k as L,aH as N,$ as te,I as re}from"./index-C2jwSk0r.js";import{C as se,s as ae,e as oe,i as U,b as ie,a as ne}from"./calendarandtasks-De7uxje-.js";import"./cjs-DVMAjUwU.js";import{A as le}from"./Add-DAmNzB04.js";import{A as de}from"./ArrowBack-Cn1Uloaa.js";import{i as v,a as ce,E as D}from"./isFuture-C0_unADd.js";import{A as me}from"./ArrowForward-BRRVjBzG.js";import{S as xe}from"./Search-CYcnagIj.js";import{s as pe,f as he}from"./format-C03WXWVb.js";import{T as ue,a as k}from"./ToggleButtonGroup-Cdv8Xj84.js";import{T as fe}from"./TextField-68ZXq3Hc.js";import{I as ye}from"./InputAdornment-D1WovqjK.js";import{C as X}from"./Chip-ChcIFS1b.js";import{C as ge}from"./Container-CVIF3dFE.js";import{G as W}from"./Grid-B8CfK59C.js";import"./Delete-DRwgYOMt.js";import"./Edit-D5AypILh.js";import"./DialogTitle-DKi6hChn.js";import"./useFormControl-Bq5GIL0l.js";import"./visuallyHidden-Dan1xhjv.js";import"./Snackbar-CFITOm7L.js";const be=({isWidget:o=!1})=>{const{user:x}=q(),s=I(),p=s.palette.mode==="dark";H();const[h,T]=m.useState([]),[u,d]=m.useState(!1),[c,Q]=m.useState(""),[b,V]=m.useState(""),[l,Y]=m.useState("all");m.useEffect(()=>{(async()=>{try{d(!0);const{data:{user:r},error:S}=await G.auth.getUser();if(S||!r){d(!1);return}const{data:w,error:j}=await G.from("tasks").select("*").eq("user_id",r.id).order("due_date",{ascending:!0});if(j)throw j;w&&T(w)}catch(r){console.error("Error fetching tasks:",r.message),Q("Failed to load tasks")}finally{d(!1)}})()},[]);const M=(t=>b?t.filter(r=>r.title.toLowerCase().includes(b.toLowerCase())||r.description&&r.description.toLowerCase().includes(b.toLowerCase())):t)((t=>{const r=new Date;switch(l){case"today":return t.filter(f=>{const y=new Date(f.due_date);return v(y)});case"week":const S=pe(r,{weekStartsOn:1}),w=ie(r,{weekStartsOn:1});return t.filter(f=>{const y=new Date(f.due_date);return U(y,{start:S,end:w})});case"month":const j=ae(r),Z=oe(r);return t.filter(f=>{const y=new Date(f.due_date);return U(y,{start:j,end:Z})});default:return t}})(h)),A=M.filter(t=>{const r=new Date(t.due_date);return v(r)}),B=M.filter(t=>{const r=new Date(t.due_date);return ce(r)&&!v(r)}),E=A.slice(0,o?2:6),O=B.slice(0,o?2:8),R=l==="all"||l==="today",$=l==="all"||l==="week"||l==="month",F=t=>{const r=new Date(t);return v(r)?"Today":he(r,"MMM d, yyyy")},_=t=>{document.dispatchEvent(new CustomEvent("openEditTaskDialog",{detail:t}))},J=t=>{V(t.target.value)},K=(t,r)=>{r!==null&&Y(r)};return e.jsxs(g,{elevation:0,sx:{p:2,borderRadius:2,bgcolor:"transparent",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",width:"100%",maxWidth:"100%"},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5,width:"100%",flexDirection:{xs:"column",sm:"row"},gap:{xs:1,sm:0}},children:[e.jsxs(i,{variant:"h6",sx:{display:"flex",alignItems:"center",fontSize:{xs:"0.95rem",sm:"1.15rem",md:"1.25rem"},width:{xs:"100%",sm:"auto"}},children:[e.jsx(D,{sx:{mr:1,fontSize:{xs:"1.2rem",sm:"1.4rem",md:"1.5rem"}}}),"Tasks"]}),e.jsxs(ue,{value:l,exclusive:!0,onChange:K,"aria-label":"task filter period",size:"small",sx:{flexWrap:"wrap","& .MuiToggleButtonGroup-grouped":{border:1,borderColor:"divider",borderRadius:1,px:{xs:1.5,sm:2},py:.75,mx:.5,fontSize:{xs:"0.7rem",sm:"0.8rem"},"&.Mui-selected":{bgcolor:n(s.palette.primary.main,.1),color:s.palette.primary.main,fontWeight:500}}},children:[e.jsx(k,{value:"all","aria-label":"all tasks",children:"All"}),e.jsx(k,{value:"today","aria-label":"today's tasks",children:"Today"}),e.jsx(k,{value:"week","aria-label":"this week's tasks",children:"Week"}),e.jsx(k,{value:"month","aria-label":"this month's tasks",children:"Month"})]})]}),e.jsx(fe,{fullWidth:!0,placeholder:"Search tasks by name or description...",variant:"outlined",size:"small",value:b,onChange:J,sx:{mb:3,width:"100%",".MuiOutlinedInput-root":{borderRadius:1.5,bgcolor:p?n(s.palette.background.paper,.3):n(s.palette.background.paper,.7),fontSize:{xs:"0.85rem",sm:"1rem"}}},InputProps:{startAdornment:e.jsx(ye,{position:"start",children:e.jsx(xe,{color:"action"})})}}),u?e.jsx(a,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(ee,{size:24})}):c?e.jsx(i,{color:"error",sx:{p:2},children:c}):e.jsxs(a,{sx:{flexGrow:1,overflow:"auto",width:"100%"},children:[R&&e.jsxs(e.Fragment,{children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,sx:{fontSize:{xs:"0.9rem",sm:"1rem",md:"1.1rem"}},children:"Today's Tasks"}),e.jsx(X,{label:A.length,size:"small",color:"primary",sx:{height:20}})]}),E.length>0?e.jsx(a,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:{xs:1.5,sm:2},mb:3,width:"100%"},children:E.map(t=>e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(g,{elevation:1,sx:{p:2,borderRadius:2,cursor:"pointer",bgcolor:t.completed?p?n(s.palette.success.main,.08):n(s.palette.success.light,.08):p?n(s.palette.background.paper,.3):n(s.palette.background.paper,.9),transition:"all 0.2s ease","&:hover":{transform:"translateY(-3px)",boxShadow:s.shadows[3]},display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",alignItems:"flex-start"},onClick:()=>_(t),children:[e.jsxs(a,{sx:{display:"flex",alignItems:"flex-start",mb:1},children:[e.jsx(a,{sx:{mr:1.5},children:t.completed?e.jsx(se,{color:"success",fontSize:"small"}):e.jsx(D,{color:"warning",fontSize:"small"})}),e.jsxs(a,{sx:{flex:1,width:"100%",overflow:"hidden"},children:[e.jsx(i,{variant:"body1",fontWeight:t.completed?400:600,sx:{textDecoration:t.completed?"line-through":"none",color:t.completed?s.palette.text.secondary:s.palette.text.primary,fontSize:{xs:"0.9rem",sm:"1rem"},overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.title}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"}},children:F(t.due_date)})]})]}),t.description&&e.jsx(i,{variant:"body2",color:"text.secondary",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",mt:"auto",pt:1,fontSize:{xs:"0.75rem",sm:"0.8rem"}},children:t.description})]})},t.id))}):e.jsx(i,{color:"text.secondary",sx:{mb:3,pl:2},variant:o?"body2":"body1",children:"No tasks scheduled for today"})]}),$&&e.jsxs(e.Fragment,{children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,mb:2,mt:R?4:0},children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,sx:{fontSize:{xs:"0.9rem",sm:"1rem",md:"1.1rem"}},children:l==="week"?"This Week's Tasks":l==="month"?"This Month's Tasks":"Upcoming Tasks"}),e.jsx(X,{label:B.length,size:"medium",color:"info",sx:{height:20}})]}),O.length>0?e.jsx(a,{sx:{display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:{xs:1.5,sm:2},width:"100%"},children:O.map(t=>e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(g,{elevation:1,sx:{p:2,borderRadius:2,cursor:"pointer",bgcolor:p?n(s.palette.background.paper,.3):n(s.palette.background.paper,.9),transition:"all 0.2s ease","&:hover":{transform:"translateY(-3px)",boxShadow:s.shadows[3]},display:"flex",flexDirection:"column",height:"100%"},onClick:()=>_(t),children:[e.jsxs(a,{sx:{display:"flex",alignItems:"flex-start",mb:1},children:[e.jsx(D,{sx:{mr:1.5},color:"info",fontSize:"small"}),e.jsxs(a,{sx:{flex:1,width:"100%",overflow:"hidden"},children:[e.jsx(i,{variant:"body1",fontWeight:600,sx:{color:s.palette.text.primary},children:t.title}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"}},children:F(t.due_date)})]})]}),t.description&&e.jsx(i,{variant:"body2",color:"text.secondary",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",mt:"auto",pt:1,fontSize:{xs:"0.75rem",sm:"0.8rem"}},children:t.description})]})},t.id))}):e.jsx(i,{color:"text.secondary",sx:{pl:2},variant:"body1",children:"No upcoming tasks scheduled"})]})]}),h.length===0&&!u&&!c&&e.jsxs(a,{sx:{textAlign:"center",py:3},children:[e.jsx(i,{variant:o?"body2":"body1",color:"text.secondary",children:"No tasks scheduled"}),e.jsx(z,{component:P,to:"/calendar",variant:"contained",color:"primary",size:o?"small":"medium",sx:{mt:2},children:"Add Task"})]}),h.length>0&&!u&&!c&&e.jsx(a,{sx:{display:"flex",justifyContent:"center",mt:"auto",pt:2},children:e.jsx(z,{component:P,to:"/calendar",variant:"outlined",color:"primary",fullWidth:!0,endIcon:e.jsx(me,{}),sx:{borderRadius:1,py:{xs:.75,sm:1},mb:2,fontWeight:500,fontSize:{xs:"0.85rem",sm:"1rem"},"&:hover":{color:"primary.main",borderColor:"primary.main",bgcolor:n(s.palette.primary.main,.05)}},children:"View All Tasks"})})]})},we=()=>{const o=I(),x=L(N.mobile);return L(N.tablet),{calendarContainer:{width:"100%",maxWidth:"100%",overflowX:"hidden",padding:x?o.spacing(1):o.spacing(2)},calendarWrapper:{width:"100%",maxWidth:"100%",overflowX:"auto","& .MuiDateCalendar-root":{width:{xs:"100%",sm:"auto"},maxWidth:"100%","& .MuiDayCalendar-header, & .MuiDayCalendar-weekContainer":{justifyContent:"space-around"}}},taskCardContainer:{width:"100%",display:"flex",flexDirection:"column",gap:{xs:1,sm:2}}}},je={width:"100%",maxWidth:"100%",overflowX:"hidden",boxSizing:"border-box",px:{xs:1,sm:2,md:3},py:{xs:2,sm:3,md:4}},qe=()=>{const o=I(),x=o.palette.mode==="dark",{isMobile:s}=te(),{user:p}=q(),h=H(),T="all",u=()=>{document.dispatchEvent(new CustomEvent("openAddTaskDialog"))},{calendarContainer:d,calendarWrapper:c}=we();return e.jsx(a,{sx:je,children:e.jsxs(ge,{maxWidth:"lg",disableGutters:!1,sx:{mt:{xs:2,sm:3},mb:{xs:4,sm:6},px:{xs:2,sm:2,md:3},boxSizing:"border-box",width:"100%",maxWidth:"100%",overflowX:"hidden"},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:{xs:2,sm:3}},children:[e.jsx(re,{onClick:()=>h(-1),sx:{mr:2},"aria-label":"go back",children:e.jsx(de,{})}),e.jsx(i,{variant:"h4",component:"h1",sx:{fontWeight:600,fontSize:{xs:"1.5rem",sm:"1.8rem",md:"2rem"}},children:"Calendar"})]}),e.jsxs(W,{container:!0,spacing:s?2:3,sx:{width:"100%",mx:0},children:[e.jsx(W,{item:!0,xs:12,children:e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(g,{elevation:2,sx:{p:{xs:2,sm:2,md:3},borderRadius:2,height:"100%",minHeight:{xs:"350px",sm:"400px",md:"500px"},bgcolor:x?n(o.palette.background.paper,.6):n(o.palette.background.paper,.8),backdropFilter:"blur(10px)",overflow:"hidden",width:"100%",position:"relative",...d},children:[e.jsx(a,{sx:c,children:e.jsx(ne,{activeTab:0,taskFrequency:T})}),e.jsx(a,{sx:{display:"flex",justifyContent:"flex-end",mt:1,mb:2,position:"relative",zIndex:5},children:e.jsx(z,{variant:"contained",color:"primary",startIcon:e.jsx(le,{}),onClick:u,sx:{borderRadius:"20px",px:2,py:1,boxShadow:"0 2px 5px rgba(0, 0, 0, 0.15)","&:hover":{boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)"}},children:"Add Task"})})]})})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:e.jsx(g,{elevation:2,sx:{p:{xs:2,sm:2,md:3},borderRadius:2,height:"100%",minHeight:{xs:"350px",sm:"400px",md:"500px"},display:"flex",flexDirection:"column",bgcolor:x?n(o.palette.background.paper,.6):n(o.palette.background.paper,.8),backdropFilter:"blur(10px)",overflow:"hidden",width:"100%",position:"relative",...d},children:e.jsx(a,{sx:{flexGrow:1,overflow:"auto",width:"100%",px:{xs:.5,sm:1}},children:e.jsx(be,{})})})})})]})]})})};export{qe as default};

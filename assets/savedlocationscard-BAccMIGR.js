import{v as I,e as H,g as N,r as s,j as e,P as h,B as r,s as c,w as z,V as B,q as D,n as u,_ as E,L as R,x as W,av as O}from"./index-BmLVi8vg.js";import{L as b}from"./LocationOn-Tjx6elGm.js";import{H as T}from"./Home-Bvsor7Mt.js";import{A as $}from"./ArrowForward-BI0FkxmS.js";import{A as y}from"./Alert-DHf0O5zk.js";import{S as P}from"./Snackbar-DxAnmTar.js";const M=()=>{const{user:V}=I(),v=H(),d=N(),a=d.palette.mode==="dark",[p,j]=s.useState([]),[w,n]=s.useState(!1),[m,L]=s.useState(""),[i,x]=s.useState({open:!1,message:"",severity:"success"});s.useEffect(()=>{(async()=>{try{n(!0);const{data:{user:t},error:A}=await W.auth.getUser();if(A||!t){n(!1);return}const{data:l,error:g}=await O.getLocations(t.id);if(g)throw g;l&&l.length>0&&j(l)}catch(t){console.error("Error fetching locations:",t.message),L("Failed to load saved locations")}finally{n(!1)}})()},[]);const C=(o,t="success")=>{x({open:!0,message:o,severity:t})},f=()=>{x({...i,open:!1})},S=o=>{if(C(`Navigating to ${o.name}`,"info"),o.address){const t=encodeURIComponent(o.address);window.open(`https://www.google.com/maps/search/?api=1&query=${t}`,"_blank")}else o.lat&&o.lng&&window.open(`https://www.google.com/maps/dir/?api=1&destination=${o.lat},${o.lng}`,"_blank")},k=()=>{v("/saved-locations")};return e.jsxs(h,{elevation:3,sx:{p:2,borderRadius:2,bgcolor:"background.paper",height:"100%",width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:e.jsx(c,{variant:"h6",gutterBottom:!0,sx:{mb:0},children:"Saved Locations"})}),e.jsx(z,{sx:{mb:2}}),w?e.jsx(r,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(B,{})}):m?e.jsx(y,{severity:"error",sx:{mb:2},children:m}):p.length>0?e.jsx(r,{sx:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:2,flexGrow:1,overflowY:"auto",pr:2,pb:1},children:p.map(o=>e.jsx(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(h,{elevation:1,onClick:()=>S(o),sx:{p:2,minHeight:"85px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",borderRadius:2,bgcolor:a?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.02)",border:"1px solid",borderColor:a?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)","&:hover":{bgcolor:a?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",transform:"translateY(-3px)",transition:"transform 0.2s ease"},cursor:"pointer",transition:"all 0.2s ease"},children:[e.jsx(r,{sx:{mb:1},children:o.isHome?e.jsx(T,{color:"primary",sx:{fontSize:28}}):e.jsx(b,{color:"secondary",sx:{fontSize:28}})}),e.jsx(c,{variant:"body2",sx:{fontWeight:o.isHome?600:400,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.2",fontSize:"0.85rem"},children:o.name})]})},o.id))}):e.jsxs(r,{sx:{p:3,textAlign:"center",bgcolor:a?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.02)",borderRadius:2,flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[e.jsx(b,{sx:{fontSize:48,color:"text.secondary",mb:2,opacity:.5}}),e.jsx(c,{color:"text.secondary",gutterBottom:!0,children:"No saved locations to display"}),e.jsx(u,{variant:"contained",color:"primary",size:"small",onClick:k,sx:{mt:1},children:"Add Locations"})]}),e.jsx(r,{sx:{mt:"auto",pt:2},children:e.jsx(u,{component:R,to:"/saved-locations",variant:"outlined",color:"primary",fullWidth:!0,endIcon:e.jsx($,{}),sx:{borderRadius:1,py:1,fontWeight:500,"&:hover":{color:"primary.main",borderColor:"primary.main",bgcolor:E(d.palette.primary.main,.05)}},children:"View All Locations"})}),e.jsx(P,{open:i.open,autoHideDuration:6e3,onClose:f,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(y,{onClose:f,severity:i.severity,sx:{width:"100%"},children:i.message})})]})};export{M as S};

import{u as z,m as G,r as c,j as e,C as U,F,B as J,K as j,A as M,T as p,aw as Y,b as _,P as D,t as w,al as a,au as v,be as T,bu as K,a as h,bv as I,ab as H,ad as Q,bw as V,bx as X,aJ as Z,aA as ee,aK as te,aL as oe,aM as se,N as ae,aC as ne,aN as re}from"./vendor-BpQ4GIZC.js";import{u as ie}from"./addMemory-C0-Amh-w.js";import"./index-AR_LmOrU.js";const xe=()=>{const W=z(),n=G(),{user:le}=ie(),b=n.palette.mode==="dark",[r,f]=c.useState(()=>{const t=localStorage.getItem("savedLocations");return t?JSON.parse(t):[]}),[s,u]=c.useState({name:"",address:"",notes:""}),[R,k]=c.useState(!1),[m,S]=c.useState(null),[x,E]=c.useState(""),[g,i]=c.useState({open:!1,message:"",severity:"success"});c.useEffect(()=>{localStorage.setItem("savedLocations",JSON.stringify(r))},[r]);const y=(t=null)=>{t!==null?(u(r[t]),S(t)):(u({name:"",address:"",notes:""}),S(null)),k(!0)},C=()=>{k(!1)},L=t=>{const{name:o,value:d}=t.target;u({...s,[o]:d})},B=()=>{if(!s.name||!s.address){i({open:!0,message:"Name and address are required",severity:"error"});return}if(m!==null){const t=[...r];t[m]=s,f(t),i({open:!0,message:"Location updated successfully",severity:"success"})}else f([...r,s]),i({open:!0,message:"Location saved successfully",severity:"success"});C()},P=t=>{const o=r.filter((d,l)=>l!==t);f(o),i({open:!0,message:"Location deleted",severity:"info"})},$=t=>{const o=encodeURIComponent(t);window.open(`https://www.google.com/maps/search/?api=1&query=${o}`,"_blank")},O=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const{latitude:o,longitude:d}=t.coords;fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${o}&lon=${d}`).then(l=>l.json()).then(l=>{const q=l.display_name||`${o}, ${d}`;u({...s,address:q})}).catch(l=>{console.error("Error getting address:",l),u({...s,address:`${o}, ${d}`})})},t=>{console.error("Error getting location:",t),i({open:!0,message:"Unable to get your current location",severity:"error"})}):i({open:!0,message:"Geolocation is not supported by your browser",severity:"error"})},A=()=>{i({...g,open:!1})},N=r.filter(t=>t.name.toLowerCase().includes(x.toLowerCase())||t.address.toLowerCase().includes(x.toLowerCase())||t.notes.toLowerCase().includes(x.toLowerCase()));return e.jsx(U,{maxWidth:"lg",sx:{py:4},children:e.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs(J,{sx:{display:"flex",alignItems:"center",mb:4},children:[e.jsx(j,{onClick:()=>W(-1),sx:{mr:2},color:"primary",children:e.jsx(M,{})}),e.jsx(p,{variant:"h4",component:"h1",sx:{fontWeight:600},children:"Saved Locations"})]}),e.jsx(Y,{open:g.open,autoHideDuration:5e3,onClose:A,anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(_,{onClose:A,severity:g.severity,sx:{width:"100%"},children:g.message})}),e.jsx(D,{elevation:2,sx:{p:3,mb:4,borderRadius:3,background:b?w(n.palette.background.paper,.6):n.palette.background.paper},children:e.jsxs(a,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(a,{item:!0,xs:12,md:8,children:e.jsx(v,{fullWidth:!0,placeholder:"Search locations...",value:x,onChange:t=>E(t.target.value),InputProps:{startAdornment:e.jsx(T,{position:"start",children:e.jsx(K,{color:"primary"})})},variant:"outlined",sx:{bgcolor:"background.paper",borderRadius:2}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(h,{fullWidth:!0,variant:"contained",color:"primary",startIcon:e.jsx(I,{}),onClick:()=>y(),sx:{py:1.5,borderRadius:2,textTransform:"none",fontWeight:600,boxShadow:"0 4px 10px rgba(0, 0, 0, 0.1)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 6px 15px rgba(0, 0, 0, 0.15)"},transition:"all 0.3s ease"},children:"Add New Location"})})]})}),e.jsx(a,{container:!0,spacing:3,children:N.length>0?N.map((t,o)=>e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(H,{elevation:2,sx:{borderRadius:3,height:"100%",display:"flex",flexDirection:"column",transition:"all 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:"0 8px 20px rgba(0, 0, 0, 0.15)"},bgcolor:b?w(n.palette.background.paper,.6):n.palette.background.paper},children:[e.jsxs(Q,{sx:{flexGrow:1},children:[e.jsx(p,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:t.name}),e.jsx(p,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:t.address}),t.notes&&e.jsx(p,{variant:"body2",color:"text.secondary",sx:{mt:1},children:t.notes})]}),e.jsxs(V,{sx:{p:2,pt:0},children:[e.jsx(h,{size:"small",startIcon:e.jsx(X,{}),onClick:()=>$(t.address),color:"primary",variant:"contained",sx:{mr:1,borderRadius:2,textTransform:"none"},children:"Navigate"}),e.jsx(j,{size:"small",onClick:()=>y(o),color:"primary",children:e.jsx(Z,{})}),e.jsx(j,{size:"small",onClick:()=>P(o),color:"error",children:e.jsx(ee,{})})]})]})},o)):e.jsx(a,{item:!0,xs:12,children:e.jsxs(D,{elevation:1,sx:{p:4,textAlign:"center",borderRadius:3,bgcolor:b?w(n.palette.background.paper,.6):n.palette.background.paper},children:[e.jsx(p,{variant:"h6",color:"text.secondary",children:x?"No locations match your search":"No saved locations yet"}),e.jsx(h,{variant:"contained",color:"primary",startIcon:e.jsx(I,{}),onClick:()=>y(),sx:{mt:2,borderRadius:2,textTransform:"none"},children:"Add Your First Location"})]})})}),e.jsxs(te,{open:R,onClose:C,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,p:1}},children:[e.jsx(oe,{sx:{fontWeight:600},children:m!==null?"Edit Location":"Add New Location"}),e.jsx(se,{children:e.jsxs(a,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(v,{fullWidth:!0,label:"Location Name",name:"name",value:s.name,onChange:L,required:!0,variant:"outlined"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(v,{fullWidth:!0,label:"Address",name:"address",value:s.address,onChange:L,required:!0,variant:"outlined",InputProps:{endAdornment:e.jsx(T,{position:"end",children:e.jsx(ae,{title:"Use current location",children:e.jsx(j,{onClick:O,edge:"end",children:e.jsx(ne,{})})})})}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(v,{fullWidth:!0,label:"Notes (optional)",name:"notes",value:s.notes,onChange:L,multiline:!0,rows:3,variant:"outlined"})})]})}),e.jsxs(re,{sx:{px:3,pb:3},children:[e.jsx(h,{onClick:C,color:"inherit",children:"Cancel"}),e.jsx(h,{onClick:B,variant:"contained",color:"primary",startIcon:e.jsx(I,{}),sx:{borderRadius:2,textTransform:"none"},children:m!==null?"Update Location":"Save Location"})]})]})]})})};export{xe as default};

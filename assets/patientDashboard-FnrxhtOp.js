import{u as K,r as c,m as Q,j as e,C as _,B as i,al as s,F as m,P as b,t as n,T as r,f as u,a as l,aB as f,n as E,o as L,aq as J,K as v,L as A,H as k,af as X,ab as G,ad as F,I as Z,b5 as O,bb as ee,ag as T,bc as te,bd as ie}from"./vendor-BpQ4GIZC.js";import{u as ae,s as D}from"./addMemory-C0-Amh-w.js";import{B as $,L as re,a as se,c as ne}from"./index-AR_LmOrU.js";const xe=()=>{const S=K(),[w,N]=c.useState(!1),{user:o}=ae(),[P,I]=c.useState(""),x=Q(),d=x.palette.mode==="dark",[g,Y]=c.useState([]),[oe,U]=c.useState(!0),[R,V]=c.useState([]);c.useEffect(()=>{(async()=>{try{const{data:{user:a},error:p}=await D.auth.getUser();if(p||!a)throw new Error("User not authenticated");const{data:M,error:W}=await D.from("memories").select("*").eq("user_id",a.id).order("date",{ascending:!1});if(W)throw W;Y(M||[]);const H=M.filter(h=>h.location&&h.location.trim()!=="").reduce((h,B)=>(h.includes(B.location)||h.push(B.location),h),[]).slice(0,3);V(H)}catch(a){console.error("Error fetching memories:",a.message)}finally{U(!1)}})()},[]);const C=()=>{S("/add-memory")},q=t=>{S(`/memory/${t}`)},z=()=>{N(!w)},y={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}};c.useEffect(()=>{const t=()=>{const p=new Date().getHours();p>=17?I("Good evening!"):p>=12?I("Good afternoon!"):I("Good morning!")};t();const a=setInterval(t,60*1e3);return()=>clearInterval(a)},[]);const j={name:(o==null?void 0:o.name)||"Guest",email:(o==null?void 0:o.email)||"",familyMembers:(o==null?void 0:o.familyMembers)||[]};return e.jsx(_,{maxWidth:"lg",sx:{mt:{xs:0,md:0},mb:6},children:e.jsx(i,{sx:{maxWidth:"100%",margin:"0 auto"},children:e.jsxs(s,{container:!0,spacing:4,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},variants:y,children:e.jsxs(b,{elevation:2,sx:{p:{xs:3,md:4},mb:5,borderRadius:3,background:d?`linear-gradient(90deg, ${n(x.palette.primary.dark,.8)} 0%, ${n(x.palette.primary.main,.6)} 100%)`:`linear-gradient(90deg, ${x.palette.primary.main} 0%, ${x.palette.primary.dark} 100%)`,color:"#fff",overflow:"hidden",position:"relative",boxShadow:d?"0 10px 30px rgba(0, 0, 0, 0.3)":"0 10px 30px rgba(0, 0, 0, 0.15)",width:"100%"},children:[e.jsx(i,{sx:{position:"absolute",top:-20,right:-20,width:"200px",height:"200px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.1)",zIndex:0}}),e.jsx(i,{sx:{position:"absolute",bottom:-40,left:-40,width:"150px",height:"150px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.05)",zIndex:0}}),e.jsxs(s,{container:!0,spacing:3,alignItems:"center",sx:{position:"relative",zIndex:1},children:[e.jsxs(s,{item:!0,xs:12,sm:7,children:[e.jsxs(r,{variant:"h4",component:"h1",sx:{fontWeight:700,mb:1,display:"flex",alignItems:"center"},children:[P," ",e.jsx(i,{component:"span",sx:{pl:1,fontWeight:400,opacity:.9},children:j.name})]}),e.jsx(r,{variant:"body1",sx:{mb:2,opacity:.9,fontSize:"1.1rem"},children:"Welcome to your memory dashboard. Ready to capture some new memories today?"}),e.jsxs(u,{direction:"row",spacing:2,children:[e.jsx(l,{variant:"contained",onClick:C,startIcon:e.jsx(f,{}),sx:{bgcolor:"white",color:x.palette.primary.main,fontWeight:600,"&:hover":{bgcolor:"rgba(255,255,255,0.9)"}},children:"Add Memory"}),e.jsx(l,{variant:"outlined",color:"inherit",startIcon:e.jsx(E,{}),onClick:z,sx:{borderColor:"rgba(255,255,255,0.5)",fontWeight:600,"&:hover":{borderColor:"white",bgcolor:"rgba(255,255,255,0.1)"}},children:"Breathing Exercise"})]}),w&&e.jsx(i,{sx:{mt:3,maxWidth:"100%",overflow:"hidden"},children:e.jsx($,{})})]}),e.jsx(s,{item:!0,xs:12,sm:5,children:e.jsx(i,{sx:{display:"flex",justifyContent:{xs:"center",sm:"flex-end"},alignItems:"center",mt:{xs:2,sm:0},transform:"scale(1.1)",transformOrigin:"right center"},children:e.jsx(re,{size:"large",withLink:!1})})})]})]})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(i,{sx:{mb:5},children:[e.jsx(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,mx:1},children:e.jsx(r,{variant:"h5",sx:{fontWeight:600},children:"Featured Memories"})}),e.jsxs(b,{elevation:2,sx:{borderRadius:3,overflow:"hidden",position:"relative",boxShadow:d?"0 10px 30px rgba(0, 0, 0, 0.3)":"0 10px 30px rgba(0, 0, 0, 0.15)",width:"900px",height:{xs:380,sm:450,md:500}},children:[e.jsxs(i,{sx:{position:"absolute",top:10,left:10,zIndex:10,display:"flex",gap:2},children:[e.jsx(l,{variant:"contained",color:"primary",startIcon:e.jsx(f,{}),onClick:C,size:"medium",sx:{px:2,py:1,borderRadius:2,boxShadow:"0 4px 10px rgba(0,0,0,0.15)",bgcolor:"primary.main"},children:"Add Memory"}),e.jsx(l,{variant:"contained",color:"primary",startIcon:e.jsx(J,{}),component:L,to:"/patient/dashboard/timeline",size:"medium",sx:{px:2,py:1,borderRadius:2,bgcolor:"rgba(255, 255, 255, 0.8)",color:"primary.main",boxShadow:"0 4px 10px rgba(0,0,0,0.15)","&:hover":{bgcolor:"white"}},children:"View Timeline"})]}),e.jsx(se,{memories:g})]})]})})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(s,{container:!0,spacing:4,children:[e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},variants:y,children:e.jsxs(b,{elevation:2,sx:{p:3,borderRadius:3,height:"100%",bgcolor:t=>t.palette.background.paper,transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:d?"0 12px 20px rgba(0, 0, 0, 0.3)":"0 12px 20px rgba(0, 0, 0, 0.1)"}},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(r,{variant:"h6",children:"Recent Locations"}),e.jsx(v,{color:"primary",size:"small",sx:{bgcolor:t=>n(t.palette.primary.main,.1)},children:e.jsx(A,{})})]}),e.jsx(k,{sx:{mb:3}}),R.length>0?e.jsx(u,{spacing:2,children:R.map((t,a)=>e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,p:1,borderRadius:1,"&:hover":{bgcolor:p=>n(p.palette.primary.main,.1)}},children:[e.jsx(A,{color:"primary",sx:{fontSize:20}}),e.jsx(r,{variant:"body1",children:t})]},a))}):e.jsx(r,{variant:"body2",color:"text.secondary",children:"No recent locations found"})]})})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},variants:y,children:e.jsxs(b,{elevation:2,sx:{p:3,borderRadius:3,height:"100%",bgcolor:t=>t.palette.background.paper,transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:d?"0 12px 20px rgba(0, 0, 0, 0.3)":"0 12px 20px rgba(0, 0, 0, 0.1)"}},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(r,{variant:"h6",children:"Family Members"}),e.jsx(v,{color:"primary",size:"small",sx:{bgcolor:t=>n(t.palette.primary.main,.1)},children:e.jsx(X,{})})]}),e.jsx(k,{sx:{mb:3}}),e.jsxs(u,{spacing:2,children:[j==null?void 0:j.familyMembers.map(t=>e.jsx(G,{variant:"outlined",sx:{borderRadius:2,boxShadow:"none",bgcolor:a=>a.palette.background.paper,transition:"all 0.3s ease","&:hover":{borderColor:"primary.main",bgcolor:a=>n(a.palette.primary.main,.05)}},children:e.jsx(F,{sx:{p:2,"&:last-child":{pb:2}},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Z,{sx:{width:32,height:32,mr:1,bgcolor:a=>a.palette.primary.main,fontSize:"0.875rem"},children:t.name.charAt(0)}),e.jsx(i,{children:e.jsx(r,{variant:"body1",children:t.name})})]}),e.jsx(v,{size:"small",children:e.jsx(O,{fontSize:"small"})})]})})},t.name)),e.jsx(l,{variant:"text",size:"small",sx:{alignSelf:"center",mt:1},children:"Manage Family"})]})]})})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},variants:y,children:e.jsxs(b,{elevation:2,sx:{p:3,borderRadius:3,height:"100%",transition:"transform 0.3s ease, box-shadow 0.3s ease",bgcolor:t=>t.palette.background.paper,"&:hover":{transform:"translateY(-5px)",boxShadow:d?"0 12px 20px rgba(0, 0, 0, 0.3)":"0 12px 20px rgba(0, 0, 0, 0.1)"}},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(r,{variant:"h6",children:"Quick Actions"}),e.jsx(v,{color:"primary",size:"small",sx:{bgcolor:t=>n(t.palette.primary.main,.1)},children:e.jsx(f,{})})]}),e.jsx(k,{sx:{mb:3}}),e.jsxs(u,{spacing:2,children:[e.jsx(l,{variant:"outlined",color:"primary",startIcon:e.jsx(f,{}),onClick:C,fullWidth:!0,sx:{justifyContent:"flex-start",py:1.5,borderRadius:2},children:"Create New Memory"}),e.jsx(l,{variant:"outlined",color:"secondary",startIcon:e.jsx(E,{}),onClick:z,fullWidth:!0,sx:{justifyContent:"flex-start",py:1.5,borderRadius:2},children:"Breathing Exercise"}),e.jsx(l,{variant:"outlined",color:"info",startIcon:e.jsx(ee,{}),fullWidth:!0,sx:{justifyContent:"flex-start",py:1.5,borderRadius:2},children:"Family Connections"})]}),w&&e.jsx(i,{sx:{mt:3},children:e.jsx($,{})})]})})})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},variants:y,children:e.jsxs(b,{elevation:2,sx:{p:3,borderRadius:3,transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:d?"0 12px 20px rgba(0, 0, 0, 0.3)":"0 12px 20px rgba(0, 0, 0, 0.1)"}},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(r,{variant:"h6",children:"Recent Memories"}),e.jsx(l,{variant:"outlined",size:"small",endIcon:e.jsx(O,{}),component:L,to:"/patient/dashboard/timeline",sx:{borderRadius:2},children:"View All"})]}),e.jsx(s,{container:!0,spacing:3,children:(g==null?void 0:g.length)>0?g.slice(0,3).map(t=>e.jsx(s,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(G,{sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:2,cursor:"pointer",transition:"all 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:a=>`0 8px 16px ${n(a.palette.primary.main,.15)}`}},onClick:()=>q(t.id),children:[t.type==="text"?e.jsxs(i,{sx:{p:3,bgcolor:n("#9c27b0",.05),height:"140px",display:"flex",alignItems:"flex-start",justifyContent:"center",flexDirection:"column",position:"relative",overflow:"hidden"},children:[e.jsx(T,{sx:{fontSize:30,color:n("#9c27b0",.6),mb:2}}),e.jsxs(r,{variant:"body1",color:"text.primary",sx:{fontStyle:"italic",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical"},children:['"',t.content,'"']}),e.jsx(i,{sx:{position:"absolute",top:10,right:10,bgcolor:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",p:.5},children:e.jsx(T,{color:"primary",fontSize:"small"})})]}):e.jsx(te,{component:"img",height:"140",image:t.content||ne,alt:t.title||"Memory"}),e.jsxs(F,{sx:{flexGrow:1},children:[e.jsx(r,{variant:"h6",component:"div",gutterBottom:!0,children:t.title||"Untitled Memory"}),e.jsxs(r,{variant:"caption",color:"text.secondary",sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ie,{fontSize:"inherit",sx:{mr:.5}}),t.date||"Unknown Date"]}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:t.description||"No description available."})]})]})},t.id)):e.jsx(r,{variant:"body1",color:"text.secondary",sx:{m:2},children:"No memories found."})})]})})})]})})})};export{xe as default};

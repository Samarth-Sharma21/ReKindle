import{v as Y,r as n,j as e,B as y,s as o,P as I,n as p,Z as ae,q as W,as as Q,at as V,au as Z,av as J,aw as K,I as A,w as X,x as F,ax as z,d as ne,ay as D,e as ie,g as ce,k as O,t as U}from"./index-CXEbI5Qv.js";import{A as le}from"./ArrowBack-EAnCmUyy.js";import{L as G}from"./LocationOn-C75YpRGj.js";import{P as de}from"./People-Jros5Tob.js";import{S as _}from"./Share-COTZSt94.js";import{B as me}from"./BreathingExercise-VZVqccj0.js";import{H as q}from"./Home-Dj5mSYWE.js";import{D as ee}from"./Delete-BHD9k2-q.js";import{A as te}from"./Add-C-yImBud.js";import{M as xe,D as he,a as ue,b as ge,c as pe}from"./MyLocation-DUgsZ4ng.js";import{A as k}from"./Alert-Db70WmmL.js";import{T as N}from"./TextField-DdE3KPGU.js";import{S as se}from"./Snackbar-DNVNLGFv.js";import{P as ye}from"./Person-D6aLZjla.js";import{P as fe}from"./Phone--LssLYud.js";import{E as je}from"./Edit-Dt1XiTsm.js";import{C as be}from"./Container-Cq2we_GA.js";import{G as H}from"./Grid-DNk133Lp.js";import{T as ve,a as $}from"./Tabs-DyV23Vdo.js";import"./index-Ddjj3efR.js";import"./useFormControl-LDH5lfHo.js";const Ce=()=>{const{user:B}=Y(),[c,l]=n.useState(null),[b,h]=n.useState(!1),[E,m]=n.useState(""),[x,f]=n.useState([]);n.useEffect(()=>{(async()=>{try{h(!0);const{data:{user:s},error:a}=await F.auth.getUser();if(a||!s){h(!1);return}const{data:g,error:T}=await z.getLocations(s.id);if(T)throw T;g&&g.length>0&&f(g)}catch(s){console.error("Error fetching locations:",s.message),m("Failed to load saved locations")}finally{h(!1)}})()},[]);const[i,C]=n.useState(""),[w,S]=n.useState(!1),[v,d]=n.useState({open:!1,message:"",severity:"success"}),L=()=>{if(!navigator.geolocation){m("Geolocation is not supported by your browser");return}h(!0),m(""),navigator.geolocation.getCurrentPosition(async t=>{try{l({lat:t.coords.latitude,lng:t.coords.longitude,address:"Current location (coordinates available)"}),h(!1),u("Location successfully detected","success")}catch{m("Error getting address from coordinates"),h(!1)}},t=>{m(`Error getting location: ${t.message}`),h(!1)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})},P=async()=>{if(!c||!i.trim()){u("Please provide a name for this location","error");return}try{const{data:{user:t},error:s}=await F.auth.getUser();if(s||!t)throw new Error("User not authenticated");const a={name:i,address:c.address,lat:c.lat,lng:c.lng,isHome:!1},{data:g,error:T}=await z.saveLocation(a,t.id);if(T)throw T;const oe=(g==null?void 0:g[0])||{...a,id:Date.now().toString()};f([...x,oe]),C(""),S(!1),u("Location saved successfully","success")}catch(t){console.error("Error saving location:",t.message),u("Failed to save location","error")}},R=async t=>{try{const s=x.find(a=>a.id===t);s&&await z.updateLocation({...s,isHome:!0},t),f(x.map(a=>({...a,isHome:a.id===t}))),u("Home location updated","success")}catch(s){console.error("Error updating home location:",s.message),u("Failed to update home location","error")}},M=async t=>{try{await z.deleteLocation(t),f(x.filter(s=>s.id!==t)),u("Location deleted","success")}catch(s){console.error("Error deleting location:",s.message),u("Failed to delete location","error")}},j=async t=>{if(navigator.share)try{await navigator.share({title:`Location: ${t.name}`,text:`Here's my location: ${t.address}`,url:`https://maps.google.com/?q=${t.address}`})}catch(s){console.error("Error sharing:",s)}else navigator.clipboard.writeText(`${t.name}: ${t.address}`),u("Location copied to clipboard","success")},u=(t,s)=>{d({open:!0,message:t,severity:s})},r=()=>{d({...v,open:!1})};return e.jsxs(y,{sx:{width:"100%"},children:[e.jsx(o,{variant:"h4",component:"h2",gutterBottom:!0,children:"Location Tracker"}),e.jsxs(I,{elevation:3,sx:{p:3,mb:4,borderRadius:2},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Current Location"}),e.jsxs(y,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(p,{variant:"contained",color:"primary",startIcon:e.jsx(xe,{}),onClick:L,disabled:b,sx:{mr:2},children:b?"Detecting...":"Get My Location"}),b&&e.jsx(ae,{size:24,sx:{ml:1}})]}),E&&e.jsx(k,{severity:"error",sx:{mb:2},children:E}),c&&e.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs(I,{variant:"outlined",sx:{p:2,mb:2},children:[e.jsxs(o,{variant:"body1",children:[e.jsx(G,{color:"primary",sx:{verticalAlign:"middle",mr:1}}),c.address]}),w?e.jsxs(y,{sx:{mt:2,display:"flex",alignItems:"flex-end"},children:[e.jsx(N,{label:"Location Name",variant:"outlined",size:"small",value:i,onChange:t=>C(t.target.value),sx:{mr:2,flexGrow:1}}),e.jsx(p,{variant:"contained",color:"primary",onClick:P,disabled:!i.trim(),children:"Save"}),e.jsx(p,{variant:"text",onClick:()=>S(!1),sx:{ml:1},children:"Cancel"})]}):e.jsx(p,{startIcon:e.jsx(te,{}),onClick:()=>S(!0),sx:{mt:2},children:"Save This Location"})]})})]}),e.jsxs(I,{elevation:3,sx:{p:3,borderRadius:2},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Saved Locations"}),x.length===0?e.jsx(o,{variant:"body1",color:"text.secondary",sx:{py:2},children:'No saved locations yet. Use the "Get My Location" button above to add locations.'}):e.jsx(Q,{children:x.map((t,s)=>e.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:s*.1},children:[e.jsxs(V,{sx:{bgcolor:t.isHome?"rgba(106, 90, 205, 0.1)":"transparent",borderRadius:1},children:[e.jsx(Z,{children:t.isHome?e.jsx(q,{color:"primary"}):e.jsx(G,{color:"secondary"})}),e.jsx(J,{primary:t.name,secondary:t.address,primaryTypographyProps:{fontWeight:t.isHome?"bold":"normal"}}),e.jsxs(K,{children:[e.jsx(Tooltip,{title:"Share Location",children:e.jsx(A,{edge:"end",onClick:()=>j(t),children:e.jsx(_,{})})}),!t.isHome&&e.jsx(Tooltip,{title:"Set as Home",children:e.jsx(A,{edge:"end",onClick:()=>R(t.id),children:e.jsx(q,{})})}),e.jsx(Tooltip,{title:"Delete Location",children:e.jsx(A,{edge:"end",onClick:()=>M(t.id),children:e.jsx(ee,{})})})]})]}),s<x.length-1&&e.jsx(X,{variant:"inset",component:"li"})]},t.id))})]}),e.jsx(se,{open:v.open,autoHideDuration:4e3,onClose:r,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(k,{onClose:r,severity:v.severity,sx:{width:"100%"},children:v.message})})]})},re=ne(e.jsx("path",{d:"M7.58 4.08 6.15 2.65C3.75 4.48 2.17 7.3 2.03 10.5h2c.15-2.65 1.51-4.97 3.55-6.42m12.39 6.42h2c-.15-3.2-1.73-6.02-4.12-7.85l-1.42 1.43c2.02 1.45 3.39 3.77 3.54 6.42M18 11c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-6 11c.14 0 .27-.01.4-.04.65-.14 1.18-.58 1.44-1.18q.15-.36.15-.78h-4c.01 1.1.9 2 2.01 2"})),we=()=>{const{user:B}=Y(),[c,l]=n.useState([]),[b,h]=n.useState(!0),[E,m]=n.useState(!1),[x,f]=n.useState(null),[i,C]=n.useState({name:"",relationship:"",phone:""}),[w,S]=n.useState({open:!1,message:"",severity:"success"}),v=()=>{f(null),C({name:"",relationship:"",phone:""}),m(!0)},d=r=>{f(r),C({name:r.name,relationship:r.relationship,phone:r.phone}),m(!0)},L=r=>{const{name:t,value:s}=r.target;C({...i,[t]:s})};n.useEffect(()=>{(async()=>{try{h(!0);const{data:{user:t},error:s}=await F.auth.getUser();if(s||!t){h(!1);return}const{data:a,error:g}=await D.getContacts(t.id);if(g)throw g;a&&l(a)}catch(t){console.error("Error fetching contacts:",t.message),j("Failed to load contacts","error")}finally{h(!1)}})()},[]);const P=async()=>{if(!i.name||!i.phone){j("Name and phone number are required","error");return}try{const{data:{user:r},error:t}=await F.auth.getUser();if(t||!r)throw new Error("User not authenticated");if(x){const s=x.id;await D.updateContact(i,s),l(c.map(a=>a.id===x.id?{...a,...i}:a)),j("Contact updated successfully","success")}else{const{data:s,error:a}=await D.saveContact(i,r.id);if(a)throw a;const g=(s==null?void 0:s[0])||{...i,id:Date.now().toString()};l([...c,g]),j("Contact added successfully","success")}}catch(r){console.error("Error saving contact:",r.message),j("Failed to save contact","error")}m(!1)},R=async r=>{try{await D.deleteContact(r),l(c.filter(t=>t.id!==r)),j("Contact deleted","success")}catch(t){console.error("Error deleting contact:",t.message),j("Failed to delete contact","error")}},M=r=>{j(`Emergency notification sent to ${r.name}`,"info")},j=(r,t)=>{S({open:!0,message:r,severity:t})},u=()=>{S({...w,open:!1})};return e.jsxs(y,{sx:{width:"100%"},children:[e.jsx(o,{variant:"h4",component:"h2",gutterBottom:!0,children:"Emergency Contacts"}),e.jsxs(I,{elevation:3,sx:{p:3,mb:4,borderRadius:2},children:[e.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(o,{variant:"h6",children:"Your Emergency Contacts"}),e.jsx(p,{variant:"contained",color:"primary",startIcon:e.jsx(te,{}),onClick:v,children:"Add Contact"})]}),c.length===0?e.jsx(k,{severity:"info",children:"No emergency contacts added yet. Add contacts who should be notified in case of emergency."}):e.jsx(Q,{children:c.map((r,t)=>e.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},children:[e.jsxs(V,{sx:{bgcolor:"background.paper",mb:1,borderRadius:1},children:[e.jsx(Z,{children:e.jsx(ye,{color:"primary"})}),e.jsx(J,{primary:e.jsx(o,{variant:"subtitle1",fontWeight:"medium",children:r.name}),secondary:e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",component:"span",children:r.relationship}),e.jsxs(y,{sx:{display:"flex",alignItems:"center",mt:.5},children:[e.jsx(fe,{fontSize:"small",sx:{mr:.5,color:"text.secondary"}}),e.jsx(o,{variant:"body2",color:"text.secondary",children:r.phone})]})]})}),e.jsxs(K,{children:[e.jsx(A,{edge:"end",color:"secondary",onClick:()=>M(r),sx:{mr:1},children:e.jsx(re,{})}),e.jsx(A,{edge:"end",onClick:()=>d(r),sx:{mr:1},children:e.jsx(je,{})}),e.jsx(A,{edge:"end",onClick:()=>R(r.id),children:e.jsx(ee,{})})]})]}),t<c.length-1&&e.jsx(X,{})]},r.id))}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:3},children:"These contacts will be notified in case of emergency. You can add family members, caregivers, or healthcare providers."})]}),e.jsxs(he,{open:E,onClose:()=>m(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ue,{children:x?"Edit Emergency Contact":"Add Emergency Contact"}),e.jsxs(ge,{children:[e.jsx(N,{autoFocus:!0,margin:"dense",name:"name",label:"Full Name",type:"text",fullWidth:!0,variant:"outlined",value:i.name,onChange:L,sx:{mb:2,mt:1}}),e.jsx(N,{margin:"dense",name:"relationship",label:"Relationship",type:"text",fullWidth:!0,variant:"outlined",value:i.relationship,onChange:L,sx:{mb:2}}),e.jsx(N,{margin:"dense",name:"phone",label:"Phone Number",type:"tel",fullWidth:!0,variant:"outlined",value:i.phone,onChange:L})]}),e.jsxs(pe,{children:[e.jsx(p,{onClick:()=>m(!1),children:"Cancel"}),e.jsx(p,{onClick:P,variant:"contained",color:"primary",children:"Save"})]})]}),e.jsx(se,{open:w.open,autoHideDuration:4e3,onClose:u,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(k,{onClose:u,severity:w.severity,sx:{width:"100%"},children:w.message})})]})},qe=()=>{const B=ie(),c=ce(),l=O(c.breakpoints.down("sm"));O(c.breakpoints.between("sm","md"));const[b,h]=n.useState(0),[E,m]=n.useState(!1),[x,f]=n.useState(!1),i=()=>{B(-1)},C=(d,L)=>{h(L)},w=()=>{m(!0),setTimeout(()=>{m(!1)},5e3)},S=()=>{f(!0),setTimeout(()=>{f(!1)},5e3)},v=()=>{B("/breathing-game")};return e.jsx(be,{maxWidth:"md",sx:{mt:{xs:2,sm:3,md:4},mb:{xs:3,sm:4,md:5},px:{xs:1.5,sm:3,md:3}},children:e.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},style:{width:"100%"},children:[e.jsxs(y,{sx:{display:"flex",alignItems:"center",mb:{xs:3,sm:4,md:5},flexDirection:{xs:"column",sm:"row"},gap:{xs:1.5,sm:0},width:"100%"},children:[e.jsx(p,{startIcon:e.jsx(le,{}),onClick:i,sx:{mr:{xs:0,sm:2},alignSelf:{xs:"flex-start",sm:"center"},mb:{xs:1,sm:0}},children:"Back"}),e.jsx(o,{variant:"h4",component:"h1",sx:{fontSize:{xs:"1.5rem",sm:"2rem",md:"2.125rem"},textAlign:{xs:"center",sm:"left"},width:{xs:"100%",sm:"auto"},fontWeight:600},children:"Help Center"})]}),e.jsxs(I,{elevation:3,sx:{p:{xs:2,sm:3},mb:{xs:3,sm:4},borderRadius:3,bgcolor:d=>d.palette.mode==="dark"?"background.card":"background.subtle",color:d=>(d.palette.mode==="dark","text.primary"),border:d=>`1px solid ${d.palette.primary.main}`,boxShadow:d=>`0 4px 12px ${d.palette.mode==="dark"?"rgba(255, 168, 77, 0.2)":"rgba(255, 138, 0, 0.15)"}`},children:[e.jsx(o,{variant:"h5",gutterBottom:!0,sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},fontWeight:600,textAlign:{xs:"center",sm:"left"}},children:"Need Immediate Help?"}),e.jsx(o,{variant:"body1",paragraph:!0,sx:{fontSize:{xs:"0.875rem",sm:"1rem"},textAlign:{xs:"center",sm:"left"},mb:{xs:2,sm:2}},children:"Use these quick actions to get help right away or to calm yourself during a moment of anxiety."}),e.jsxs(H,{container:!0,spacing:2,children:[e.jsx(H,{item:!0,xs:12,sm:6,md:4,children:e.jsx(p,{variant:"contained",fullWidth:!0,size:l?"medium":"large",color:"secondary",startIcon:e.jsx(_,{}),onClick:w,sx:{py:{xs:1,sm:1.5},borderRadius:2,boxShadow:2,fontSize:{xs:"0.8rem",sm:"0.9rem",md:"1rem"},"&:hover":{boxShadow:4}},children:"Share My Location"})}),e.jsx(H,{item:!0,xs:12,sm:6,md:4,children:e.jsx(p,{variant:"contained",fullWidth:!0,size:l?"medium":"large",color:"primary",startIcon:e.jsx(re,{}),onClick:S,sx:{py:{xs:1,sm:1.5},borderRadius:2,boxShadow:2,fontSize:{xs:"0.8rem",sm:"0.9rem",md:"1rem"},"&:hover":{boxShadow:4}},children:"Alert Emergency Contacts"})}),e.jsx(H,{item:!0,xs:12,sm:6,md:4,sx:{mx:{xs:"auto",sm:0},width:{xs:"100%",sm:"auto"},mt:{xs:1,sm:0}},children:e.jsx(p,{variant:"contained",fullWidth:!0,size:l?"medium":"large",color:"secondary",startIcon:e.jsx(U,{}),onClick:v,sx:{py:{xs:1,sm:1.5},borderRadius:2,boxShadow:2,fontSize:{xs:"0.8rem",sm:"0.9rem",md:"1rem"},"&:hover":{boxShadow:4}},children:"Breathing Exercise"})})]}),E&&e.jsx(k,{severity:"success",sx:{mt:2},children:"Your location has been shared with your emergency contacts."}),x&&e.jsx(k,{severity:"info",sx:{mt:2},children:"Emergency alert has been sent to your contacts. They will contact you shortly."})]}),e.jsxs(I,{elevation:2,sx:{borderRadius:3,overflow:"hidden",boxShadow:d=>d.palette.mode==="dark"?"0 8px 16px rgba(0, 0, 0, 0.4)":"0 8px 16px rgba(0, 0, 0, 0.1)",mb:{xs:4,sm:0}},children:[e.jsxs(ve,{value:b,onChange:C,variant:l?"scrollable":"fullWidth",scrollButtons:l?"auto":!1,allowScrollButtonsMobile:!0,sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{minHeight:{xs:"48px",sm:"64px"},fontSize:{xs:"0.8rem",sm:"0.9rem"},minWidth:{xs:"auto",sm:"160px"},px:{xs:1,sm:2}}},children:[e.jsx($,{icon:e.jsx(G,{}),label:l?"":"Location Sharing",iconPosition:"start","aria-label":"Location Sharing"}),e.jsx($,{icon:e.jsx(de,{}),label:l?"":"Emergency Contacts",iconPosition:"start","aria-label":"Emergency Contacts"}),e.jsx($,{icon:e.jsx(U,{}),label:l?"":"Breathing Exercise",iconPosition:"start","aria-label":"Breathing Exercise"})]}),b===0&&e.jsxs(y,{sx:{p:{xs:2,sm:3}},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1.1rem",sm:"1.25rem"},fontWeight:600,textAlign:{xs:"center",md:"left"},mb:{xs:1.5,sm:2}},children:"Share Your Location"}),e.jsx(o,{variant:"body2",paragraph:!0,color:"text.secondary",sx:{textAlign:{xs:"center",sm:"left"},mb:{xs:2,sm:2.5}},children:"Your location can be shared with your emergency contacts to help them find you in case of an emergency."}),e.jsx(Ce,{})]}),b===1&&e.jsxs(y,{sx:{p:{xs:2,sm:3}},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1.1rem",sm:"1.25rem"},fontWeight:600,textAlign:{xs:"center",md:"left"},mb:{xs:1.5,sm:2}},children:"Emergency Contacts"}),e.jsx(o,{variant:"body2",paragraph:!0,color:"text.secondary",sx:{textAlign:{xs:"center",sm:"left"},mb:{xs:2,sm:2.5}},children:"Add and manage your emergency contacts who will be notified when you need help."}),e.jsx(we,{})]}),b===2&&e.jsxs(y,{sx:{p:{xs:2,sm:3}},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,fontSize:{xs:"1.1rem",sm:"1.25rem"},textAlign:{xs:"center",md:"left"},mb:{xs:1.5,sm:2}},children:"Breathing Exercise"}),e.jsx(o,{variant:"body2",paragraph:!0,color:"text.secondary",sx:{mb:{xs:2,sm:3},textAlign:{xs:"center",sm:"left"}},children:"Follow this guided breathing exercise to help calm yourself during moments of anxiety."}),e.jsx(me,{}),e.jsx(y,{sx:{mt:3,textAlign:"center"},children:e.jsx(p,{variant:"outlined",color:"primary",size:l?"medium":"large",startIcon:e.jsx(U,{}),onClick:v,sx:{borderRadius:2,py:{xs:.75,sm:1},px:{xs:2,sm:3},fontSize:{xs:"0.8rem",sm:"0.9rem"}},children:"Open Full Breathing Game"})})]})]})]})})};export{qe as default};
